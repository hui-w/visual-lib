function $(){var c=new Array();for(var b=0;b<arguments.length;b++){var a=arguments[b];if(typeof a=="string"){a=document.getElementById(a)}if(arguments.length==1){return a}c.push(a)}return c}function getQueryStringByName(c,b){if(b==null){b=location.search}var a=b.match(new RegExp("[?&]"+c+"=([^&]+)","i"));if(a==null||a.length<1){return null}else{return a[1]}}function getScreenWidth(){return document.documentElement.clientWidth}function isSmallScreen(){return getScreenWidth()<800}Element.prototype.hasClassName=function(b){return new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)").test(this.className)};Element.prototype.addClassName=function(b){if(!this.hasClassName(b)){this.className=[this.className,b].join(" ")}};Element.prototype.removeClassName=function(c){if(this.hasClassName(c)){var d=this.className;this.className=d.replace(new RegExp("(?:^|\\s+)"+c+"(?:\\s+|$)","g")," ")}};Element.prototype.toggleClassName=function(b){this[this.hasClassName(b)?"removeClassName":"addClassName"](b)};var PropertieDictionary={AxisChart:[["borderSize","Number","Border Size","General"],["borderColor","String","Border Color","General"],["showShadow","Boolean","Show Shadow (inheritable)","General"],["shadowStyle","Json","Shadow Style","General"],["padding","Json","Padding","General"],["data","Json","Data","General"],["showAxis","Boolean","Show Axis","Axis"],["showScaleLabel","Boolean","Show Scale Label","Axis"],["showScaleLine","Boolean","Show Scale Line","Axis"],["xLabel","String","X Axis Label","Axis"],["yLabel","String","Y Axis Label","Axis"],["arrowSize","Number","Arrow Size","Axis"],["arrowStyle","Number","Arrow Style","Axis",{"0":"Solid","1":"Empty"}],["scaleCount","Number","Scale Count","Axis"],["scaleLineColor","String","Scale Line Color","Axis"],["scaleLineSize","Number","Scale Line Size","Axis"],["zeroAsOrigin","Boolean","Zero As Origin","Axis"],["showKeys","Boolean","Show Keys","Key"],["keys","Json","Keys","Key"],["keyFont","Json","Key Font","Key"],["keyRotate","Number","Key Rotate","Key"],["keyBaseline","String","Key Baseline","Key",{top:"Top",bottom:"Bottom",middle:"Middle",alphabetic:"Alphabetic",hanging:"Hanging"}],["keyAltitude","Number","Key Altitude","Key"],["barDensity","Number","Bar Density","Bar"],["barSpacing","Number","Bar Spacing","Bar"],["showValueOnBar","Boolean","Show Value On Bar (inheritable)","Bar"],["selectedBarColor","String","Selected Bar Color","Bar"],["lineSize","Number","Line Size (inheritable)","Line"],["linePointSize","Number","Line Point Size (inheritable)","Line"],["fitting","Boolean","Fitting (inheritable)","Line"],["showSlider","Boolean","Show Slider","Slider"],["sliderWidth","Number","Slider Width","Slider"],["sliderHeight","Number","Slider Height","Slider"],["sliderAltitude","Number","Slider Altitude","Slider"],["sliderBlurColor","String","Slider Blur Color","Slider"],["sliderFocusColor","String","Slider Focus Color","Slider"]],PieChart:[["borderSize","Number","Border Size","General"],["borderColor","String","Border Color","General"],["padding","Json","Padding","General"],["data","Json","Data","General"],["baseAngle","Number","Base Angle","General"],["dataUnit","String","Data Unit","General"],["showTitles","Boolean","Show Titles","Title"],["titleFont","Json","Title Font","Title"],["selectedBorderSize","Number","Selected Border Size","Data Selection"],["selectedBorderColor","String","Selected Border Color","Data Selection"],["selectedValueFont","Json","Selected Value Font","Data Selection"],["selectMode","Number","Select Mode","Data Selection",{0:"None",1:"Click",2:"Scroll"}],["arrowColor","String","Arrow Color","Data Selection"],["showSelectedDetail","Boolean","Show Selected Detail","Data Selection"],["selectedDetailFont","Json","Selected Detail Font","Data Selection"]],RadarChart:[["borderSize","Number","Border Size","General"],["borderColor","String","Border Color","General"],["padding","Json","Padding","General"],["data","Json","Data","General"],["baseValue","Number","Base Value","General"],["fillColor","String","Fill Color","General"],["outerStyle","Number","Outter Style","General",{0:"Circle",1:"Polygon"}],["lineColor","String","Line Color","General"],["titleFont","Json","Title Font","Title"],["baseAngle","Number","Base Angle","General"]]};var axisChart=null;var pieChart=null;var radarChart=null;var propertyWnd=null;var jsonEditor=null;function sandbox_load(){try{document.createElement("canvas").getContext("2d")}catch(b){alert("HTML5 Canvas not supported by your browser");return}renderAxisChart();renderPieChart();renderRadarChart();showColorTable();propertyWnd=new PropertyWnd();propertyWnd.addObject({id:"axisChart",items:PropertieDictionary.AxisChart});propertyWnd.addObject({id:"pieChart",items:PropertieDictionary.PieChart});propertyWnd.addObject({id:"radarChart",items:PropertieDictionary.RadarChart});propertyWnd.renderInto("propertyWndWrapper");loadAxisSample(0);loadPieSample(0);loadRadarSample(0);propertyWnd.show(null);var a={mode:"tree",modes:["code","form","text","tree","view"],error:function(c){alert(c.toString())}};jsonEditor=new JSONEditor($("jsonEditor"),a);windowResized()}var axisSamples=[{data:[{type:"bar",color:"RGBA(0,150,214,0.8)",selectedColor:"#87DB39",values:[30,40,50,20,80,100,120,55,10,20,8,72]},{type:"line",color:"#D53F26",showShadow:true,values:[120,60,30,70,60,67,99,55,80,40,13,30]},{type:"line",color:"#009F73",fitting:true,linePointSize:0,values:[67,99,110,80,40,13,30,120,130,80,70,90]}],keys:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],showSlider:false,padding:{top:10,right:30,bottom:30,left:50},xLabel:"Month",yLabel:"Value",showScaleLine:false,showAxis:true},{data:[{type:"bar",values:[30,40,50,20,80,100,120,55,10,20]}],keys:["1","2","3","4","5","6","7","8","9","10"]},{data:[{type:"line",shadow:"true",values:[120,60,30,70,60,67,99,55,80,20]}],keys:["1","2","3","4","5","6","7","8","9","10"]},{data:[{type:"bar",values:[30,40,50,20,80,100,120,55,10,20]},{type:"line",fitting:"true",values:[120,60,30,70,60,67,99,55,80,20]}],keys:["1","2","3","4","5","6","7","8","9","10"]},{data:[{type:"bar",color:"#00B1D4",values:[30,40,50,20,80,100,120,55]},{type:"bar",color:"#00D435",values:[120,60,30,70,60,67,10,20]}],keys:["Q1 FY13","Q2 FY13","Q3 FY13","Q4 FY13","Q1 FY14","Q2 FY14","Q3 FY14","Q3 FY14"]},{data:[{type:"bar",values:[30,40,50,20,80,100,120,55,10,20]},{type:"line",values:[120,60,30,70,60,67,99,55,80,20]},{type:"line",values:[70,66,67,120,43,30,12,null,24,16]}],keys:["1","2","3","4","5","6","7","8","9","10"]},{showSlider:true,padding:{top:10,right:30,bottom:60,left:50}},{showScaleLine:true,showAxis:false}];var pieSamples=[{data:[{color:"#4057A7",title:"Apple",value:12},{color:"#F25822",title:"Orange",value:6},{color:"#00ff00",title:"Kiwi",value:8},{color:"#FBD602",title:"Banana",value:4}],padding:{top:10,right:10,bottom:10,left:10},selectMode:1,showSelectedDetail:true},{data:[{color:"#00ff00",title:"Pass",value:40},{color:"#ff3300",title:"Failed",value:12},{color:"#ffff00",title:"Blocked",value:5},{color:"#0099cc",title:"No Run",value:3}]},{selectMode:2,showTitles:false,showSelectedDetail:true},{data:[{color:"#ff0000",title:"255,0,0",value:1},{color:"#ff3300",title:"255,51,0",value:1},{color:"#ff6600",title:"255,102,0",value:1},{color:"#ff9900",title:"255,153,0",value:1},{color:"#ffff00",title:"255,255,0",value:1},{color:"#99ff00",title:"153,255,0",value:1},{color:"#00ff00",title:"0,255,0",value:1},{color:"#00ffff",title:"0,255,255",value:1},{color:"#0000ff",title:"0,0,255",value:1},{color:"#6600ff",title:"102,0,255",value:1},{color:"#ff00ff",title:"255,0,255",value:1},{color:"#ff0066",title:"255,0,102",value:1}],dataUnit:"",showSelectedDetail:""}];var radarSamples=[{data:[{title:"Specific",value:8},{title:"Measurable",value:5},{title:"Attainable",value:4},{title:"Relevant",value:6},{title:"Time-bound",value:7}],outerStyle:0},{data:[{title:"Innovation",value:4},{title:"Presentation",value:2},{title:"Business",value:3},{title:"Technical",value:3}],baseValue:5},{outerStyle:1}];function showJsonEditor(a){jsonEditor.set(a);jsonEditor.setMode("tree");$("mask").removeClassName("hidden")}function closeJsonEditor(b){$("mask").addClassName("hidden");if(b){var c=$("jsonEditorWrapper").getAttribute("data-inputId");var d=jsonEditor.get();var a=JSON.stringify(d);$(c).value=a;$(c).focus();$(c).blur()}}function windowResized(){if(isSmallScreen()){if(!$("propertyWnd").hasClassName("hidden")){$("propertyWnd").addClassName("hidden");$("output").addClassName("hidden");$("axisTools").addClassName("hidden");$("pieTools").addClassName("hidden")}axisChart.borderSize=0;axisChart.keyRotate=-45;axisChart.keyAltitude=-20;axisChart.keyBaseline="hanging";axisChart.linePointSize=2;axisChart.showSlider=true;axisChart.sliderWidth=10;axisChart.sliderHeight=16;axisChart.sliderAltitude=-40;axisChart.padding={top:10,right:25,bottom:60,left:30};axisChart.redraw();pieChart.borderSize=0;pieChart.showTitles=false;pieChart.selectMode=2;pieChart.redraw();return}else{if($("propertyWnd").hasClassName("hidden")){$("propertyWnd").removeClassName("hidden");$("output").removeClassName("hidden");$("axisTools").removeClassName("hidden");$("pieTools").removeClassName("hidden")}}var c=document.documentElement.clientHeight?document.documentElement:document.body,a=c.scrollHeight>c.clientHeight?c.scrollHeight:c.clientHeight,d=c.scrollWidth>c.clientWidth?c.scrollWidth:c.clientWidth;$("mask").style.width=d+"px";$("mask").style.height=a+"px";$("jsonEditorWrapper").style.height=document.documentElement.clientHeight*0.8+"px";$("jsonEditorWrapper").style.marginTop=document.documentElement.clientHeight*0.1+"px";$("jsonEditor").style.height=(document.documentElement.clientHeight*0.8-40)+"px";makeMovable("propertyHeader","propertyWnd",-10,10,300);makeMovable("outputHeader","output",-10,550,300)}function renderAxisChart(){var b=600;var a=300;if(isSmallScreen()){b=getScreenWidth()-20;a=b*0.6}axisChart=new AxisChart(b,a,"pnl_Axis");axisChart.selChanged=function(){if(axisChart.selectedIndex==-1){log("[Axis]Cancel Selected")}else{log("[Axis]Selected Values: <b>["+axisChart.getSelectedValues()+"]</b>")}};axisChart.render()}function renderPieChart(){var b=400;var a=250;if(isSmallScreen()){b=(getScreenWidth()-20)*0.8;a=b}pieChart=new PieChart(b,a,"pnl_Pie");pieChart.selChanged=function(){if(pieChart.selectedIndex==-1){log("[Pie]Cancel Selected")}else{log("[Pie]Selected Value: <b>["+pieChart.getSelectedItem().title+", "+pieChart.getSelectedItem().value+"]</b>")}};pieChart.render()}function renderRadarChart(){var b=400;var a=300;if(isSmallScreen()){b=(getScreenWidth()-20)*0.8;a=b}radarChart=new RadarChart(b,a,"pnl_Radar");radarChart.render()}function showColorTable(){for(var a=0;a<axisChart.colors.length;a++){$("defaultColorTable").createChild("div",{style:"float: left; width: 24px; height: 24px; background-color: "+axisChart.colors[a],title:"Default Color Table "+a+": "+axisChart.colors[a]})}}function loadAxisSample(c){var b=axisSamples[c];for(var a in b){axisChart[a]=b[a]}axisChart.redraw();propertyWnd.show("axisChart",axisChart.canvas)}function loadPieSample(c){var b=pieSamples[c];for(var a in b){pieChart[a]=b[a]}pieChart.redraw();propertyWnd.show("pieChart",pieChart.canvas)}function loadRadarSample(c){var b=radarSamples[c];for(var a in b){radarChart[a]=b[a]}radarChart.redraw();propertyWnd.show("radarChart",radarChart.canvas)}function log(){var b="";for(var a=0;a<arguments.length;a++){b+=arguments[a];if(a!=arguments.length-1){b+=" "}}$("outputBody").innerHTML=b+"<br />"+$("outputBody").innerHTML}function selectAxisByIndex(){try{var a=window.prompt("Input an index:",1);axisChart.selectByIndex(parseInt(a))}catch(b){alert(b)}}function getCodes(object,type){var payload=[];var propDictItem=PropertieDictionary[type];var tempObj=eval("new "+type+"()");for(var i=0;i<propDictItem.length;i++){var key=propDictItem[i][0];var value=eval(object+"."+key);var tempValue=tempObj[key];if(value!=tempValue){payload.push([key,value])}}location.href="example.html?type="+type+"&payload="+base64.encode(JSON.stringify(payload))}function example_load(){try{document.createElement("canvas").getContext("2d")}catch(e){alert("HTML5 Canvas not supported by your browser");return}var type=getQueryStringByName("type");var payload=getQueryStringByName("payload");if(type==null||payload==null){$("codes").innerHTML="No Data";return}try{var codes="";var properties=JSON.parse(base64.decode(payload));var propDictItem=PropertieDictionary[type];var width=600;var height=300;if(isSmallScreen()){width=getScreenWidth()-20;height=width*0.6}$("codes").style.width=width+"px";$("codes").style.height=height+"px";var chart=eval("new "+type+"("+width+", "+height+", 'preview')");codes+="var chart = new "+type+'(600, 300, "ContainerDivId");\n';for(var i=0;i<properties.length;i++){var key=properties[i][0];var value=properties[i][1];chart[key]=value;var type=getPropType(propDictItem,key);if(type=="String"){codes+="chart."+key+' = "'+value+'";\n'}else{if(type=="Json"){codes+="chart."+key+" = "+JSON.stringify(value)+";\n"}else{codes+="chart."+key+" = "+value+";\n"}}}chart.render();codes+="chart.render();\n";$("codes").innerHTML=codes}catch(err){alert(err)}}function getPropType(a,c){for(var b=0;b<a.length;b++){if(a[b][0]==c){return a[b][1]}}return null}function PropertyWnd(){this.domObj=null;this.header=null;this.labelObjId=null;this.body=null;this.objects=[];this.sortType=1;this.selectedId=null;this.renderInto=function(wrapperId){var that=this;this.domObj=$(wrapperId).createChild("div",{id:"propertyWnd","class":"propertyWnd"});this.header=this.domObj.createChild("div",{id:"propertyHeader","class":"header"},"Properties");var alphabetic=this.header.createChild("span",{"class":"sort-button"},"A-Z");var category=this.header.createChild("span",{"class":"sort-button selected"},"Cate");alphabetic.onclick=function(){if(that.sortType==0){return}that.sortType=0;that.show(that.selectedId);this.addClassName("selected");category.removeClassName("selected")};category.onclick=function(){if(that.sortType==1){return}that.sortType=1;that.show(that.selectedId);this.addClassName("selected");alphabetic.removeClassName("selected")};this.labelObjId=this.header.createChild("span");this.body=this.domObj.createChild("div",{"class":"body"});this.show(null)};this.addObject=function(obj){this.objects.push(obj)};this.alphabeticSort=function(a,b){return a[2]>b[2]?1:-1};this.categorySort=function(a,b){if(a[3]==b[3]){return a[2]>b[2]?1:-1}else{return a[3]>b[3]?1:-1}};this.show=function(propId,snapToObj){this.selectedId=propId;this.body.scrollLeft=0;this.body.scrollTop=0;while(this.body.firstChild){this.body.removeChild(this.body.firstChild)}if(snapToObj){var left=snapToObj.offsetLeft+snapToObj.width+10;var top=snapToObj.offsetTop;makeMovable("propertyHeader","propertyWnd",left,top)}if(this.selectedId){for(var i=0;i<this.objects.length;i++){var obj=this.objects[i];if(obj.id==this.selectedId){this.labelObjId.innerHTML=" ["+obj.id+"]";var items=obj.items;if(this.sortType==1){items.sort(this.categorySort)}else{items.sort(this.alphabeticSort)}var previousCategory=null;var categoryBody=null;var categoryId=0;for(var j=0;j<items.length;j++){var item=items[j];var prop=item[0];var type=item[1];var title=item[2];var cate=item[3];var options=item[4];if(this.sortType==1){if(previousCategory!=cate){categoryId++;var categoryHeader=this.body.createChild("div",{"class":"category-header expand","data-index":categoryId},cate);previousCategory=cate;categoryBody=this.body.createChild("div",{id:"categoryBody_"+categoryId,"class":"hidden"});categoryHeader.onclick=function(e){var bodyId="categoryBody_"+this.attributes["data-index"].value;if($(bodyId).hasClassName("hidden")){$(bodyId).removeClassName("hidden");this.addClassName("collapse");this.removeClassName("expand")}else{$(bodyId).addClassName("hidden");this.addClassName("expand");this.removeClassName("collapse")}}}this.appendProperty(categoryBody,prop,type,title,options)}else{this.appendProperty(this.body,prop,type,title,options)}}return}}}this.labelObjId.innerHTML="";this.body.createChild("div",{style:"text-align: center; padding: 10px 0px;"},"Select an object to check the settings")};this.appendProperty=function(parent,prop,type,title,options){var that=this;var fieldset=parent.createChild("fieldset",null);fieldset.setAttribute("data-bindObj",this.selectedId);fieldset.setAttribute("data-bindType",type);fieldset.setAttribute("data-bindProp",prop);var legend=fieldset.createChild("legend",null,title);var formControl=null;if(options!=null){formControl=document.createElement("select");var selectedIndex=0;var i=0;for(var key in options){var text=options[key];formControl.createChild("option",{value:key},text);if(eval(this.selectedId+"."+prop)==key){selectedIndex=i}i++}formControl.selectedIndex=selectedIndex;formControl.onchange=function(){var objId=this.parentNode.getAttribute("data-bindObj");var prop=this.parentNode.getAttribute("data-bindProp");var type=this.parentNode.getAttribute("data-bindType");var selectedValue=this.options[this.selectedIndex].value;if(type=="String"){eval(objId+"."+prop+" = '"+selectedValue+"'")}else{eval(objId+"."+prop+" = "+selectedValue)}eval(objId).redraw()}}else{switch(type){case"Number":formControl=document.createElement("input");formControl.type="text";formControl.value=eval(this.selectedId+"."+prop);formControl.setAttribute("onkeypress","return event.keyCode>=48&&event.keyCode<=57||event.keyCode==46||event.keyCode==45");formControl.setAttribute("onpaste","return !clipboardData.getData('text').match(/D/)");formControl.setAttribute("ondragenter","return false");formControl.setAttribute("style","width: 30px; ime-mode:Disabled");formControl.onkeydown=function(){if(event.keyCode==13){this.blur()}};break;case"String":formControl=document.createElement("input");formControl.type="text";formControl.value=eval(this.selectedId+"."+prop);formControl.setAttribute("style","width: 100%; ime-mode:Disabled");formControl.onkeydown=function(){if(event.keyCode==13){this.blur()}};break;case"Boolean":formControl=document.createElement("select");formControl.createChild("option",null,"True");formControl.createChild("option",null,"False");formControl.selectedIndex=eval(this.selectedId+"."+prop)?0:1;formControl.onchange=function(){this.blur()};break;case"Json":formControl=document.createElement("textarea");formControl.setAttribute("style","width: 100%; height: 80px; ime-mode:Disabled");formControl.value=JSON.stringify(eval(this.selectedId+"."+prop));break;default:break}formControl.onblur=function(){try{var objId=this.parentNode.getAttribute("data-bindObj");var prop=this.parentNode.getAttribute("data-bindProp");var type=this.parentNode.getAttribute("data-bindType");switch(type){case"Number":eval(objId+"."+prop+" = "+this.value);break;case"String":eval(objId+"."+prop+" = '"+this.value+"'");break;case"Boolean":var value=this.selectedIndex==0?true:false;eval(objId+"."+prop+" = "+value);break;case"Json":eval(objId+"."+prop+" = JSON.parse('"+this.value+"')");break;default:break}eval(objId).redraw()}catch(err){alert(err)}}}if(formControl!=null){formControl.id="propControl_"+this.selectedId+"."+prop;fieldset.appendChild(formControl)}if(type=="Json"){var button=fieldset.createChild("a",{href:"#"},"Editor");button.onclick=function(){var objId=this.parentNode.getAttribute("data-bindObj");var prop=this.parentNode.getAttribute("data-bindProp");$("jsonEditorWrapper").setAttribute("data-inputId","propControl_"+that.selectedId+"."+prop);eval("showJsonEditor("+objId+"."+prop+");")}}}}var maxZIndex=0;function makeMovable(i,a,d,c,b,j){var g=$(i);var f=$(a);b=b?b:0;j=j?j:0;var e=d>=0?d:document.documentElement.clientWidth+d-b;var h=c>=0?c:document.documentElement.clientHeight+c-j;f.style.position="absolute";f.style.left=e+"px";f.style.top=h+"px";f.style.zIndex=++maxZIndex;f.onmousedown=function(k){this.style.zIndex=++maxZIndex};g.onselectstart=function(){return(false)};g.onmousedown=function(m){var k=m.pageX;var l=m.pageY;document.onmousemove=function(n){e+=n.pageX-k;h+=n.pageY-l;f.style.left=e+"px";f.style.top=h+"px";k=n.pageX;l=n.pageY};document.onmouseup=function(){document.onmousemove=null}}}
/*!
 * jsoneditor.js
 *
 * @brief
 * JSONEditor is a web-based tool to view, edit, and format JSON.
 * It shows data a clear, editable treeview.
 *
 * Supported browsers: Chrome, Firefox, Safari, Opera, Internet Explorer 8+
 *
 * @license
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 *
 * Copyright (c) 2011-2014 Jos de Jong, http://jsoneditoronline.org
 *
 * @author  Jos de Jong, <wjosdejong@gmail.com>
 * @version 3.0.0
 * @date    2014-05-31
 */
!function(b,a){"object"==typeof exports&&"object"==typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):"object"==typeof exports?exports.JSONEditor=a():b.JSONEditor=a()}(this,function(){return function(c){function b(e){if(a[e]){return a[e].exports}var d=a[e]={exports:{},id:e,loaded:!1};return c[e].call(d.exports,d,d.exports,b),d.loaded=!0,d.exports}var a={};return b.m=c,b.c=a,b.p="",b(0)}([function(c,b,a){var f,d;f=[a(1),a(2),a(3)],d=function(j,h,g){function k(m,i,n){if(!(this instanceof k)){throw new Error('JSONEditor constructor called without "new".')}var l=g.getInternetExplorerVersion();if(-1!=l&&9>l){throw new Error("Unsupported browser, IE9 or newer required. Please install the newest version of your browser.")}arguments.length&&this._create(m,i,n)}return k.modes={},k.prototype._create=function(o,m,l){this.container=o,this.options=m||{},this.json=l||{};var p=this.options.mode||"tree";this.setMode(p)},k.prototype._delete=function(){},k.prototype.set=function(i){this.json=i},k.prototype.get=function(){return this.json},k.prototype.setText=function(i){this.json=g.parse(i)},k.prototype.getText=function(){return JSON.stringify(this.json)},k.prototype.setName=function(i){this.options||(this.options={}),this.options.name=i},k.prototype.getName=function(){return this.options&&this.options.name},k.prototype.setMode=function(q){var l,v,n=this.container,p=g.extend({},this.options);p.mode=q;var i=k.modes[q];if(!i){throw new Error('Unknown mode "'+p.mode+'"')}try{var u="text"==i.data;if(v=this.getName(),l=this[u?"getText":"get"](),this._delete(),g.clear(this),g.extend(this,i.mixin),this.create(n,p),this.setName(v),this[u?"setText":"set"](l),"function"==typeof i.load){try{i.load.call(this)}catch(m){}}}catch(m){this._onError(m)}},k.prototype._onError=function(i){if("function"==typeof this.onError&&(g.log("WARNING: JSONEditor.onError is deprecated. Use options.error instead."),this.onError(i)),!this.options||"function"!=typeof this.options.error){throw i}this.options.error(i)},k.registerMode=function(n){var i,p;if(g.isArray(n)){for(i=0;i<n.length;i++){k.registerMode(n[i])}}else{if(!("mode" in n)){throw new Error('Property "mode" missing')}if(!("mixin" in n)){throw new Error('Property "mixin" missing')}if(!("data" in n)){throw new Error('Property "data" missing')}var l=n.mode;if(l in k.modes){throw new Error('Mode "'+l+'" already registered')}if("function"!=typeof n.mixin.create){throw new Error('Required function "create" missing on mixin')}var m=["setMode","registerMode","modes"];for(i=0;i<m.length;i++){if(p=m[i],p in n.mixin){throw new Error('Reserved property "'+p+'" not allowed in mixin')}}k.modes[l]=n}},k.registerMode(j),k.registerMode(h),k}.apply(null,f),!(void 0!==d&&(c.exports=d))},function(c,b,a){var f,d;f=[a(4),a(5),a(6),a(7),a(8),a(3)],d=function(l,q,k,j,h,u){var g={};g.create=function(e,o){if(!e){throw new Error("No container element provided.")}this.container=e,this.dom={},this.highlighter=new l,this.selection=void 0,this._setOptions(o),this.options.history&&!this.mode.view&&(this.history=new q(this)),this._createFrame(),this._createTable()},g._delete=function(){this.frame&&this.container&&this.frame.parentNode==this.container&&this.container.removeChild(this.frame)},g._setOptions=function(n){if(this.options={search:!0,history:!0,mode:"tree",name:void 0},n){for(var i in n){n.hasOwnProperty(i)&&(this.options[i]=n[i])}}this.mode={edit:"view"!=this.options.mode&&"form"!=this.options.mode,view:"view"==this.options.mode,form:"form"==this.options.mode}};var p=void 0,m=null;return g.set=function(w,s){if(s&&(u.log('Warning: second parameter "name" is deprecated. Use setName(name) instead.'),this.options.name=s),w instanceof Function||void 0===w){this.clear()}else{this.content.removeChild(this.table);var n={field:this.options.name,value:w},x=new j(this,n);this._setRoot(x);var v=!1;this.node.expand(v),this.content.appendChild(this.table)}this.history&&this.history.clear()},g.get=function(){return p&&p.blur(),this.node?this.node.getValue():void 0},g.getText=function(){return JSON.stringify(this.get())},g.setText=function(i){this.set(u.parse(i))},g.setName=function(i){this.options.name=i,this.node&&this.node.updateField(this.options.name)},g.getName=function(){return this.options.name},g.clear=function(){this.node&&(this.node.collapse(),this.tbody.removeChild(this.node.getDom()),delete this.node)},g._setRoot=function(i){this.clear(),this.node=i,this.tbody.appendChild(i.getDom())},g.search=function(n){var i;return this.node?(this.content.removeChild(this.table),i=this.node.search(n),this.content.appendChild(this.table)):i=[],i},g.expandAll=function(){this.node&&(this.content.removeChild(this.table),this.node.expand(),this.content.appendChild(this.table))},g.collapseAll=function(){this.node&&(this.content.removeChild(this.table),this.node.collapse(),this.content.appendChild(this.table))},g._onAction=function(r,o){if(this.history&&this.history.add(r,o),this.options.change){try{this.options.change()}catch(n){u.log("Error in change callback: ",n)}}},g.startAutoScroll=function(y){var w=this,v=this.content,B=u.getAbsoluteTop(v),A=v.clientHeight,x=B+A,s=24,z=50;this.autoScrollStep=B+s>y&&v.scrollTop>0?(B+s-y)/3:y>x-s&&A+v.scrollTop<v.scrollHeight?(x-s-y)/3:void 0,this.autoScrollStep?this.autoScrollTimer||(this.autoScrollTimer=setInterval(function(){w.autoScrollStep?v.scrollTop-=w.autoScrollStep:w.stopAutoScroll()},z)):this.stopAutoScroll()},g.stopAutoScroll=function(){this.autoScrollTimer&&(clearTimeout(this.autoScrollTimer),delete this.autoScrollTimer),this.autoScrollStep&&delete this.autoScrollStep},g.setSelection=function(i){i&&("scrollTop" in i&&this.content&&(this.content.scrollTop=i.scrollTop),i.range&&u.setSelectionOffset(i.range),i.dom&&i.dom.focus())},g.getSelection=function(){return{dom:m,scrollTop:this.content?this.content.scrollTop:0,range:u.getSelectionOffset()}},g.scrollTo=function(A,x){var w=this.content;if(w){var C=this;C.animateTimeout&&(clearTimeout(C.animateTimeout),delete C.animateTimeout),C.animateCallback&&(C.animateCallback(!1),delete C.animateCallback);var B=w.clientHeight,y=w.scrollHeight-B,z=Math.min(Math.max(A-B/4,0),y),v=function(){var i=w.scrollTop,n=z-i;Math.abs(n)>3?(w.scrollTop+=n/3,C.animateCallback=x,C.animateTimeout=setTimeout(v,50)):(x&&x(!0),w.scrollTop=z,delete C.animateTimeout,delete C.animateCallback)};v()}else{x&&x(!1)}},g._createFrame=function(){function w(n){o._onEvent(n)}this.frame=document.createElement("div"),this.frame.className="jsoneditor",this.container.appendChild(this.frame);var o=this;this.frame.onclick=function(n){var e=n.target;w(n),"BUTTON"==e.nodeName&&n.preventDefault()},this.frame.oninput=w,this.frame.onchange=w,this.frame.onkeydown=w,this.frame.onkeyup=w,this.frame.oncut=w,this.frame.onpaste=w,this.frame.onmousedown=w,this.frame.onmouseup=w,this.frame.onmouseover=w,this.frame.onmouseout=w,u.addEventListener(this.frame,"focus",w,!0),u.addEventListener(this.frame,"blur",w,!0),this.frame.onfocusin=w,this.frame.onfocusout=w,this.menu=document.createElement("div"),this.menu.className="menu",this.frame.appendChild(this.menu);var y=document.createElement("button");y.className="expand-all",y.title="Expand all fields",y.onclick=function(){o.expandAll()},this.menu.appendChild(y);var v=document.createElement("button");if(v.title="Collapse all fields",v.className="collapse-all",v.onclick=function(){o.collapseAll()},this.menu.appendChild(v),this.history){var i=document.createElement("button");i.className="undo separator",i.title="Undo last action (Ctrl+Z)",i.onclick=function(){o._onUndo()},this.menu.appendChild(i),this.dom.undo=i;var x=document.createElement("button");x.className="redo",x.title="Redo (Ctrl+Shift+Z)",x.onclick=function(){o._onRedo()},this.menu.appendChild(x),this.dom.redo=x,this.history.onChange=function(){i.disabled=!o.history.canUndo(),x.disabled=!o.history.canRedo()},this.history.onChange()}if(this.options&&this.options.modes&&this.options.modes.length){var s=h.create(this,this.options.modes,this.options.mode);this.menu.appendChild(s),this.dom.modeBox=s}this.options.search&&(this.searchBox=new k(this,this.menu))},g._onUndo=function(){this.history&&(this.history.undo(),this.options.change&&this.options.change())},g._onRedo=function(){this.history&&(this.history.redo(),this.options.change&&this.options.change())},g._onEvent=function(r){var o=r.target;"keydown"==r.type&&this._onKeyDown(r),"focus"==r.type&&(m=o);var n=j.getNodeFromTarget(o);n&&n.onEvent(r)},g._onKeyDown=function(x){var v=x.which||x.keyCode,s=x.ctrlKey,z=x.shiftKey,y=!1;if(9==v&&setTimeout(function(){u.selectContentEditable(m)},0),this.searchBox){if(s&&70==v){this.searchBox.dom.search.focus(),this.searchBox.dom.search.select(),y=!0}else{if(114==v||s&&71==v){var w=!0;z?this.searchBox.previous(w):this.searchBox.next(w),y=!0}}}this.history&&(s&&!z&&90==v?(this._onUndo(),y=!0):s&&z&&90==v&&(this._onRedo(),y=!0)),y&&(x.preventDefault(),x.stopPropagation())},g._createTable=function(){var n=document.createElement("div");n.className="outer",this.contentOuter=n,this.content=document.createElement("div"),this.content.className="tree",n.appendChild(this.content),this.table=document.createElement("table"),this.table.className="tree",this.content.appendChild(this.table);var i;this.colgroupContent=document.createElement("colgroup"),this.mode.edit&&(i=document.createElement("col"),i.width="24px",this.colgroupContent.appendChild(i)),i=document.createElement("col"),i.width="24px",this.colgroupContent.appendChild(i),i=document.createElement("col"),this.colgroupContent.appendChild(i),this.table.appendChild(this.colgroupContent),this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.frame.appendChild(n)},[{mode:"tree",mixin:g,data:"json"},{mode:"view",mixin:g,data:"json"},{mode:"form",mixin:g,data:"json"}]}.apply(null,f),!(void 0!==d&&(c.exports=d))},function(c,b,a){var f,d;f=[a(8),a(3)],d=function(j,h){var g={};return g.create=function(q,m){m=m||{},this.options=m,this.indentation=m.indentation?Number(m.indentation):2,this.mode="code"==m.mode?"code":"text","code"==this.mode&&"undefined"==typeof ace&&(this.mode="text",h.log("WARNING: Cannot load code editor, Ace library not loaded. Falling back to plain text editor"));var k=this;this.container=q,this.dom={},this.editor=void 0,this.textarea=void 0,this.width=q.clientWidth,this.height=q.clientHeight,this.frame=document.createElement("div"),this.frame.className="jsoneditor",this.frame.onclick=function(i){i.preventDefault()},this.menu=document.createElement("div"),this.menu.className="menu",this.frame.appendChild(this.menu);var w=document.createElement("button");w.className="format",w.title="Format JSON data, with proper indentation and line feeds",this.menu.appendChild(w),w.onclick=function(){try{k.format()}catch(i){k._onError(i)}};var e=document.createElement("button");if(e.className="compact",e.title="Compact JSON data, remove all whitespaces",this.menu.appendChild(e),e.onclick=function(){try{k.compact()}catch(i){k._onError(i)}},this.options&&this.options.modes&&this.options.modes.length){var v=j.create(this,this.options.modes,this.options.mode);this.menu.appendChild(v),this.dom.modeBox=v}if(this.content=document.createElement("div"),this.content.className="outer",this.frame.appendChild(this.content),this.container.appendChild(this.frame),"code"==this.mode){this.editorDom=document.createElement("div"),this.editorDom.style.height="100%",this.editorDom.style.width="100%",this.content.appendChild(this.editorDom);var u=ace.edit(this.editorDom);u.setTheme("ace/theme/jsoneditor"),u.setShowPrintMargin(!1),u.setFontSize(13),u.getSession().setMode("ace/mode/json"),u.getSession().setTabSize(2),u.getSession().setUseSoftTabs(!0),u.getSession().setUseWrapMode(!0),this.editor=u;var t=document.createElement("a");t.appendChild(document.createTextNode("powered by ace")),t.href="http://ace.ajax.org",t.target="_blank",t.className="poweredBy",t.onclick=function(){window.open(t.href,t.target)},this.menu.appendChild(t),m.change&&u.on("change",function(){m.change()})}else{var p=document.createElement("textarea");p.className="text",p.spellcheck=!1,this.content.appendChild(p),this.textarea=p,m.change&&(null===this.textarea.oninput?this.textarea.oninput=function(){m.change()}:this.textarea.onchange=function(){m.change()})}},g._delete=function(){this.frame&&this.container&&this.frame.parentNode==this.container&&this.container.removeChild(this.frame)},g._onError=function(i){if("function"==typeof this.onError&&(h.log("WARNING: JSONEditor.onError is deprecated. Use options.error instead."),this.onError(i)),!this.options||"function"!=typeof this.options.error){throw i}this.options.error(i)},g.compact=function(){var i=h.parse(this.getText());this.setText(JSON.stringify(i))},g.format=function(){var i=h.parse(this.getText());this.setText(JSON.stringify(i,null,this.indentation))},g.focus=function(){this.textarea&&this.textarea.focus(),this.editor&&this.editor.focus()},g.resize=function(){if(this.editor){var i=!1;this.editor.resize(i)}},g.set=function(i){this.setText(JSON.stringify(i,null,this.indentation))},g.get=function(){return h.parse(this.getText())},g.getText=function(){return this.textarea?this.textarea.value:this.editor?this.editor.getValue():""},g.setText=function(i){this.textarea&&(this.textarea.value=i),this.editor&&this.editor.setValue(i,-1)},[{mode:"text",mixin:g,data:"text",load:g.format},{mode:"code",mixin:g,data:"text",load:g.format}]}.apply(null,f),!(void 0!==d&&(c.exports=d))},function(c,b,a){var d;d=function(){var h={};h.parse=function(j){try{return JSON.parse(j)}catch(e){throw h.validate(j),e}},h.validate=function(i){"undefined"!=typeof jsonlint?jsonlint.parse(i):JSON.parse(i)},h.extend=function(l,k){for(var j in k){k.hasOwnProperty(j)&&(l[j]=k[j])}return l},h.clear=function(j){for(var i in j){j.hasOwnProperty(i)&&delete j[i]}return j},h.log=function(){"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},h.type=function(e){return null===e?"null":void 0===e?"undefined":e instanceof Number||"number"==typeof e?"number":e instanceof String||"string"==typeof e?"string":e instanceof Boolean||"boolean"==typeof e?"boolean":e instanceof RegExp||"regexp"==typeof e?"regexp":h.isArray(e)?"array":"object"};var g=/^https?:\/\/\S+$/;h.isUrl=function(i){return("string"==typeof i||i instanceof String)&&g.test(i)},h.isArray=function(i){return"[object Array]"===Object.prototype.toString.call(i)},h.getAbsoluteLeft=function(j){var i=j.getBoundingClientRect();return i.left+window.pageXOffset||document.scrollLeft||0},h.getAbsoluteTop=function(j){var i=j.getBoundingClientRect();return i.top+window.pageYOffset||document.scrollTop||0},h.addClassName=function(l,k){var j=l.className.split(" ");-1==j.indexOf(k)&&(j.push(k),l.className=j.join(" "))},h.removeClassName=function(l,k){var j=l.className.split(" "),m=j.indexOf(k);-1!=m&&(j.splice(m,1),l.className=j.join(" "))},h.stripFormatting=function(k){for(var j=k.childNodes,u=0,q=j.length;q>u;u++){var l=j[u];l.style&&l.removeAttribute("style");var m=l.attributes;if(m){for(var e=m.length-1;e>=0;e--){var p=m[e];1==p.specified&&l.removeAttribute(p.name)}}h.stripFormatting(l)}},h.setEndOfContentEditable=function(l){var k,j;document.createRange&&(k=document.createRange(),k.selectNodeContents(l),k.collapse(!1),j=window.getSelection(),j.removeAllRanges(),j.addRange(k))},h.selectContentEditable=function(l){if(l&&"DIV"==l.nodeName){var k,j;window.getSelection&&document.createRange&&(j=document.createRange(),j.selectNodeContents(l),k=window.getSelection(),k.removeAllRanges(),k.addRange(j))}},h.getSelection=function(){if(window.getSelection){var i=window.getSelection();if(i.getRangeAt&&i.rangeCount){return i.getRangeAt(0)}}return null},h.setSelection=function(j){if(j&&window.getSelection){var i=window.getSelection();i.removeAllRanges(),i.addRange(j)}},h.getSelectionOffset=function(){var e=h.getSelection();return e&&"startOffset" in e&&"endOffset" in e&&e.startContainer&&e.startContainer==e.endContainer?{startOffset:e.startOffset,endOffset:e.endOffset,container:e.startContainer.parentNode}:null},h.setSelectionOffset=function(j){if(document.createRange&&window.getSelection){var e=window.getSelection();if(e){var k=document.createRange();k.setStart(j.container.firstChild,j.startOffset),k.setEnd(j.container.firstChild,j.endOffset),h.setSelection(k)}}},h.getInnerText=function(w,p){var k=void 0==p;if(k&&(p={text:"",flush:function(){var i=this.text;return this.text="",i},set:function(i){this.text=i}}),w.nodeValue){return p.flush()+w.nodeValue}if(w.hasChildNodes()){for(var j=w.childNodes,x="",e=0,v=j.length;v>e;e++){var u=j[e];if("DIV"==u.nodeName||"P"==u.nodeName){var q=j[e-1],m=q?q.nodeName:void 0;m&&"DIV"!=m&&"P"!=m&&"BR"!=m&&(x+="\n",p.flush()),x+=h.getInnerText(u,p),p.set("\n")}else{"BR"==u.nodeName?(x+=p.flush(),p.set("\n")):x+=h.getInnerText(u,p)}}return x}return"P"==w.nodeName&&-1!=h.getInternetExplorerVersion()?p.flush():""},h.getInternetExplorerVersion=function(){if(-1==f){var j=-1;if("Microsoft Internet Explorer"==navigator.appName){var i=navigator.userAgent,k=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=k.exec(i)&&(j=parseFloat(RegExp.$1))}f=j}return f},h.isFirefox=function(){return -1!=navigator.userAgent.indexOf("Firefox")};var f=-1;return h.addEventListener=function(j,e,m,l){if(j.addEventListener){return void 0===l&&(l=!1),"mousewheel"===e&&h.isFirefox()&&(e="DOMMouseScroll"),j.addEventListener(e,m,l),m}if(j.attachEvent){var k=function(){return m.call(j,window.event)};return j.attachEvent("on"+e,k),k}},h.removeEventListener=function(j,e,l,k){j.removeEventListener?(void 0===k&&(k=!1),"mousewheel"===e&&h.isFirefox()&&(e="DOMMouseScroll"),j.removeEventListener(e,l,k)):j.detachEvent&&j.detachEvent("on"+e,l)},h}.call(b,a,b,c),!(void 0!==d&&(c.exports=d))},function(c,b,a){var d;d=function(){function f(){this.locked=!1}return f.prototype.highlight=function(g){this.locked||(this.node!=g&&(this.node&&this.node.setHighlight(!1),this.node=g,this.node.setHighlight(!0)),this._cancelUnhighlight())},f.prototype.unhighlight=function(){if(!this.locked){var g=this;this.node&&(this._cancelUnhighlight(),this.unhighlightTimer=setTimeout(function(){g.node.setHighlight(!1),g.node=void 0,g.unhighlightTimer=void 0},0))}},f.prototype._cancelUnhighlight=function(){this.unhighlightTimer&&(clearTimeout(this.unhighlightTimer),this.unhighlightTimer=void 0)},f.prototype.lock=function(){this.locked=!0},f.prototype.unlock=function(){this.locked=!1},f}.call(b,a,b,c),!(void 0!==d&&(c.exports=d))},function(c,b,a){var f,d;f=[a(3)],d=function(h){function g(i){this.editor=i,this.clear(),this.actions={editField:{undo:function(j){j.node.updateField(j.oldValue)},redo:function(j){j.node.updateField(j.newValue)}},editValue:{undo:function(j){j.node.updateValue(j.oldValue)},redo:function(j){j.node.updateValue(j.newValue)}},appendNode:{undo:function(j){j.parent.removeChild(j.node)},redo:function(j){j.parent.appendChild(j.node)}},insertBeforeNode:{undo:function(j){j.parent.removeChild(j.node)},redo:function(j){j.parent.insertBefore(j.node,j.beforeNode)}},insertAfterNode:{undo:function(j){j.parent.removeChild(j.node)},redo:function(j){j.parent.insertAfter(j.node,j.afterNode)}},removeNode:{undo:function(l){var k=l.parent,j=k.childs[l.index]||k.append;k.insertBefore(l.node,j)},redo:function(j){j.parent.removeChild(j.node)}},duplicateNode:{undo:function(j){j.parent.removeChild(j.clone)},redo:function(j){j.parent.insertAfter(j.clone,j.node)}},changeType:{undo:function(j){j.node.changeType(j.oldType)},redo:function(j){j.node.changeType(j.newType)}},moveNode:{undo:function(j){j.startParent.moveTo(j.node,j.startIndex)},redo:function(j){j.endParent.moveTo(j.node,j.endIndex)}},sort:{undo:function(k){var j=k.node;j.hideChilds(),j.sort=k.oldSort,j.childs=k.oldChilds,j.showChilds()},redo:function(k){var j=k.node;j.hideChilds(),j.sort=k.newSort,j.childs=k.newChilds,j.showChilds()}}}}return g.prototype.onChange=function(){},g.prototype.add=function(j,i){this.index++,this.history[this.index]={action:j,params:i,timestamp:new Date},this.index<this.history.length-1&&this.history.splice(this.index+1,this.history.length-this.index-1),this.onChange()},g.prototype.clear=function(){this.history=[],this.index=-1,this.onChange()},g.prototype.canUndo=function(){return this.index>=0},g.prototype.canRedo=function(){return this.index<this.history.length-1},g.prototype.undo=function(){if(this.canUndo()){var j=this.history[this.index];if(j){var e=this.actions[j.action];e&&e.undo?(e.undo(j.params),j.params.oldSelection&&this.editor.setSelection(j.params.oldSelection)):h.log('Error: unknown action "'+j.action+'"')}this.index--,this.onChange()}},g.prototype.redo=function(){if(this.canRedo()){this.index++;var j=this.history[this.index];if(j){var e=this.actions[j.action];e&&e.redo?(e.redo(j.params),j.params.newSelection&&this.editor.setSelection(j.params.newSelection)):h.log('Error: unknown action "'+j.action+'"')}this.onChange()}},g}.apply(null,f),!(void 0!==d&&(c.exports=d))},function(c,b,a){var d;d=function(){function f(y,D){var v=this;this.editor=y,this.timeout=void 0,this.delay=200,this.lastText=void 0,this.dom={},this.dom.container=D;var m=document.createElement("table");this.dom.table=m,m.className="search",D.appendChild(m);var k=document.createElement("tbody");this.dom.tbody=k,m.appendChild(k);var E=document.createElement("tr");k.appendChild(E);var g=document.createElement("td");E.appendChild(g);var B=document.createElement("div");this.dom.results=B,B.className="results",g.appendChild(B),g=document.createElement("td"),E.appendChild(g);var z=document.createElement("div");this.dom.input=z,z.className="frame",z.title="Search fields and values",g.appendChild(z);var w=document.createElement("table");z.appendChild(w);var q=document.createElement("tbody");w.appendChild(q),E=document.createElement("tr"),q.appendChild(E);var A=document.createElement("button");A.className="refresh",g=document.createElement("td"),g.appendChild(A),E.appendChild(g);var C=document.createElement("input");this.dom.search=C,C.oninput=function(h){v._onDelayedSearch(h)},C.onchange=function(h){v._onSearch(h)},C.onkeydown=function(h){v._onKeyDown(h)},C.onkeyup=function(h){v._onKeyUp(h)},A.onclick=function(){C.select()},g=document.createElement("td"),g.appendChild(C),E.appendChild(g);var j=document.createElement("button");j.title="Next result (Enter)",j.className="next",j.onclick=function(){v.next()},g=document.createElement("td"),g.appendChild(j),E.appendChild(g);var x=document.createElement("button");x.title="Previous result (Shift+Enter)",x.className="previous",x.onclick=function(){v.previous()},g=document.createElement("td"),g.appendChild(x),E.appendChild(g)}return f.prototype.next=function(h){if(void 0!=this.results){var g=void 0!=this.resultIndex?this.resultIndex+1:0;g>this.results.length-1&&(g=0),this._setActiveResult(g,h)}},f.prototype.previous=function(j){if(void 0!=this.results){var h=this.results.length-1,g=void 0!=this.resultIndex?this.resultIndex-1:h;0>g&&(g=h),this._setActiveResult(g,j)}},f.prototype._setActiveResult=function(k,h){if(this.activeResult){var g=this.activeResult.node,m=this.activeResult.elem;"field"==m?delete g.searchFieldActive:delete g.searchValueActive,g.updateDom()}if(!this.results||!this.results[k]){return this.resultIndex=void 0,void (this.activeResult=void 0)}this.resultIndex=k;var l=this.results[this.resultIndex].node,j=this.results[this.resultIndex].elem;"field"==j?l.searchFieldActive=!0:l.searchValueActive=!0,this.activeResult=this.results[this.resultIndex],l.updateDom(),l.scrollTo(function(){h&&l.focus(j)})},f.prototype._clearDelay=function(){void 0!=this.timeout&&(clearTimeout(this.timeout),delete this.timeout)},f.prototype._onDelayedSearch=function(){this._clearDelay();var g=this;this.timeout=setTimeout(function(e){g._onSearch(e)},this.delay)},f.prototype._onSearch=function(j,h){this._clearDelay();var g=this.dom.search.value,l=g.length>0?g:void 0;if(l!=this.lastText||h){if(this.lastText=l,this.results=this.editor.search(l),this._setActiveResult(void 0),void 0!=l){var k=this.results.length;switch(k){case 0:this.dom.results.innerHTML="no&nbsp;results";break;case 1:this.dom.results.innerHTML="1&nbsp;result";break;default:this.dom.results.innerHTML=k+"&nbsp;results"}}else{this.dom.results.innerHTML=""}}},f.prototype._onKeyDown=function(h){var g=h.which;27==g?(this.dom.search.value="",this._onSearch(h),h.preventDefault(),h.stopPropagation()):13==g&&(h.ctrlKey?this._onSearch(h,!0):h.shiftKey?this.previous():this.next(),h.preventDefault(),h.stopPropagation())},f.prototype._onKeyUp=function(h){var g=h.keyCode;27!=g&&13!=g&&this._onDelayedSearch(h)},f}.call(b,a,b,c),!(void 0!==d&&(c.exports=d))},function(c,b,a){var f,d;f=[a(9),a(10),a(3)],d=function(j,h,g){function l(m,i){this.editor=m,this.dom={},this.expanded=!1,i&&i instanceof Object?(this.setField(i.field,i.fieldEditable),this.setValue(i.value,i.type)):(this.setField(""),this.setValue(null))}l.prototype.setParent=function(i){this.parent=i},l.prototype.setField=function(m,i){this.field=m,this.fieldEditable=1==i},l.prototype.getField=function(){return void 0===this.field&&this._getDomField(),this.field},l.prototype.setValue=function(v,p){var n,x,q=this.childs;if(q){for(;q.length;){this.removeChild(q[0])}}if(this.type=this._getType(v),p&&p!=this.type){if("string"!=p||"auto"!=this.type){throw new Error('Type mismatch: cannot cast value of type "'+this.type+' to the specified type "'+p+'"')}this.type=p}if("array"==this.type){this.childs=[];for(var u=0,m=v.length;m>u;u++){n=v[u],void 0===n||n instanceof Function||(x=new l(this.editor,{value:n}),this.appendChild(x))}this.value=""}else{if("object"==this.type){this.childs=[];for(var w in v){v.hasOwnProperty(w)&&(n=v[w],void 0===n||n instanceof Function||(x=new l(this.editor,{field:w,value:n}),this.appendChild(x)))}this.value=""}else{this.childs=void 0,this.value=v}}},l.prototype.getValue=function(){if("array"==this.type){var m=[];return this.childs.forEach(function(e){m.push(e.getValue())}),m}if("object"==this.type){var i={};return this.childs.forEach(function(n){i[n.getField()]=n.getValue()}),i}return void 0===this.value&&this._getDomValue(),this.value},l.prototype.getLevel=function(){return this.parent?this.parent.getLevel()+1:0},l.prototype.clone=function(){var m=new l(this.editor);if(m.type=this.type,m.field=this.field,m.fieldInnerText=this.fieldInnerText,m.fieldEditable=this.fieldEditable,m.value=this.value,m.valueInnerText=this.valueInnerText,m.expanded=this.expanded,this.childs){var i=[];this.childs.forEach(function(e){var o=e.clone();o.setParent(m),i.push(o)}),m.childs=i}else{m.childs=void 0}return m},l.prototype.expand=function(i){this.childs&&(this.expanded=!0,this.dom.expand&&(this.dom.expand.className="expanded"),this.showChilds(),0!=i&&this.childs.forEach(function(e){e.expand(i)}))},l.prototype.collapse=function(i){this.childs&&(this.hideChilds(),0!=i&&this.childs.forEach(function(e){e.collapse(i)}),this.dom.expand&&(this.dom.expand.className="collapsed"),this.expanded=!1)},l.prototype.showChilds=function(){var q=this.childs;if(q&&this.expanded){var p=this.dom.tr,m=p?p.parentNode:void 0;if(m){var s=this.getAppend(),r=p.nextSibling;r?m.insertBefore(s,r):m.appendChild(s),this.childs.forEach(function(i){m.insertBefore(i.getDom(),s),i.showChilds()})}}},l.prototype.hide=function(){var m=this.dom.tr,i=m?m.parentNode:void 0;i&&i.removeChild(m),this.hideChilds()},l.prototype.hideChilds=function(){var m=this.childs;if(m&&this.expanded){var i=this.getAppend();i.parentNode&&i.parentNode.removeChild(i),this.childs.forEach(function(n){n.hide()})}},l.prototype.appendChild=function(p){if(this._hasChilds()){if(p.setParent(this),p.fieldEditable="object"==this.type,"array"==this.type&&(p.index=this.childs.length),this.childs.push(p),this.expanded){var o=p.getDom(),m=this.getAppend(),q=m?m.parentNode:void 0;m&&q&&q.insertBefore(o,m),p.showChilds()}this.updateDom({updateIndexes:!0}),p.updateDom({recurse:!0})}},l.prototype.moveBefore=function(p,o){if(this._hasChilds()){var m=this.dom.tr?this.dom.tr.parentNode:void 0;if(m){var q=document.createElement("tr");q.style.height=m.clientHeight+"px",m.appendChild(q)}p.parent&&p.parent.removeChild(p),o instanceof k?this.appendChild(p):this.insertBefore(p,o),m&&m.removeChild(q)}},l.prototype.moveTo=function(p,o){if(p.parent==this){var m=this.childs.indexOf(p);o>m&&o++}var q=this.childs[o]||this.append;this.moveBefore(p,q)},l.prototype.insertBefore=function(r,p){if(this._hasChilds()){if(p==this.append){r.setParent(this),r.fieldEditable="object"==this.type,this.childs.push(r)}else{var m=this.childs.indexOf(p);if(-1==m){throw new Error("Node not found")}r.setParent(this),r.fieldEditable="object"==this.type,this.childs.splice(m,0,r)}if(this.expanded){var v=r.getDom(),u=p.getDom(),q=u?u.parentNode:void 0;u&&q&&q.insertBefore(v,u),r.showChilds()}this.updateDom({updateIndexes:!0}),r.updateDom({recurse:!0})}},l.prototype.insertAfter=function(p,o){if(this._hasChilds()){var m=this.childs.indexOf(o),q=this.childs[m+1];q?this.insertBefore(p,q):this.appendChild(p)}},l.prototype.search=function(w){var q,p=[],y=w?w.toLowerCase():void 0;if(delete this.searchField,delete this.searchValue,void 0!=this.field){var x=String(this.field).toLowerCase();q=x.indexOf(y),-1!=q&&(this.searchField=!0,p.push({node:this,elem:"field"})),this._updateDomField()}if(this._hasChilds()){if(this.childs){var u=[];this.childs.forEach(function(e){u=u.concat(e.search(w))}),p=p.concat(u)}if(void 0!=y){var v=!1;0==u.length?this.collapse(v):this.expand(v)}}else{if(void 0!=this.value){var m=String(this.value).toLowerCase();q=m.indexOf(y),-1!=q&&(this.searchValue=!0,p.push({node:this,elem:"value"}))}this._updateDomValue()}return p},l.prototype.scrollTo=function(o){if(!this.dom.tr||!this.dom.tr.parentNode){for(var n=this.parent,m=!1;n;){n.expand(m),n=n.parent}}this.dom.tr&&this.dom.tr.parentNode&&this.editor.scrollTo(this.dom.tr.offsetTop,o)},l.focusElement=void 0,l.prototype.focus=function(m){if(l.focusElement=m,this.dom.tr&&this.dom.tr.parentNode){var i=this.dom;switch(m){case"drag":i.drag?i.drag.focus():i.menu.focus();break;case"menu":i.menu.focus();break;case"expand":this._hasChilds()?i.expand.focus():i.field&&this.fieldEditable?(i.field.focus(),g.selectContentEditable(i.field)):i.value&&!this._hasChilds()?(i.value.focus(),g.selectContentEditable(i.value)):i.menu.focus();break;case"field":i.field&&this.fieldEditable?(i.field.focus(),g.selectContentEditable(i.field)):i.value&&!this._hasChilds()?(i.value.focus(),g.selectContentEditable(i.value)):this._hasChilds()?i.expand.focus():i.menu.focus();break;case"value":default:i.value&&!this._hasChilds()?(i.value.focus(),g.selectContentEditable(i.value)):i.field&&this.fieldEditable?(i.field.focus(),g.selectContentEditable(i.field)):this._hasChilds()?i.expand.focus():i.menu.focus()}}},l.select=function(i){setTimeout(function(){g.selectContentEditable(i)},0)},l.prototype.blur=function(){this._getDomValue(!1),this._getDomField(!1)},l.prototype._duplicate=function(m){var i=m.clone();return this.insertAfter(i,m),i},l.prototype.containsNode=function(p){if(this==p){return !0}var o=this.childs;if(o){for(var m=0,q=o.length;q>m;m++){if(o[m].containsNode(p)){return !0}}}return !1},l.prototype._move=function(o,n){if(o!=n){if(o.containsNode(this)){throw new Error("Cannot move a field into a child of itself")}o.parent&&o.parent.removeChild(o);var m=o.clone();o.clearDom(),n?this.insertBefore(m,n):this.appendChild(m)}},l.prototype.removeChild=function(o){if(this.childs){var n=this.childs.indexOf(o);if(-1!=n){o.hide(),delete o.searchField,delete o.searchValue;var m=this.childs.splice(n,1)[0];return this.updateDom({updateIndexes:!0}),m}}return void 0},l.prototype._remove=function(i){this.removeChild(i)},l.prototype.changeType=function(q){var p=this.type;if(p!=q){if("string"!=q&&"auto"!=q||"string"!=p&&"auto"!=p){var m,s=this.dom.tr?this.dom.tr.parentNode:void 0;m=this.expanded?this.getAppend():this.getDom();var r=m&&m.parentNode?m.nextSibling:void 0;this.hide(),this.clearDom(),this.type=q,"object"==q?(this.childs||(this.childs=[]),this.childs.forEach(function(i){i.clearDom(),delete i.index,i.fieldEditable=!0,void 0==i.field&&(i.field="")}),("string"==p||"auto"==p)&&(this.expanded=!0)):"array"==q?(this.childs||(this.childs=[]),this.childs.forEach(function(n,i){n.clearDom(),n.fieldEditable=!1,n.index=i}),("string"==p||"auto"==p)&&(this.expanded=!0)):this.expanded=!1,s&&(r?s.insertBefore(this.getDom(),r):s.appendChild(this.getDom())),this.showChilds()}else{this.type=q}("auto"==q||"string"==q)&&(this.value="string"==q?String(this.value):this._stringCast(String(this.value)),this.focus()),this.updateDom({updateIndexes:!0})}},l.prototype._getDomValue=function(p){if(this.dom.value&&"array"!=this.type&&"object"!=this.type&&(this.valueInnerText=g.getInnerText(this.dom.value)),void 0!=this.valueInnerText){try{var i;if("string"==this.type){i=this._unescapeHTML(this.valueInnerText)}else{var r=this._unescapeHTML(this.valueInnerText);i=this._stringCast(r)}if(i!==this.value){var q=this.value;this.value=i,this.editor._onAction("editValue",{node:this,oldValue:q,newValue:i,oldSelection:this.editor.selection,newSelection:this.editor.getSelection()})}}catch(m){if(this.value=void 0,1!=p){throw m}}}},l.prototype._updateDomValue=function(){var u=this.dom.value;if(u){var m=this.value,w="auto"==this.type?g.type(m):this.type,v="string"==w&&g.isUrl(m),p="";p=v&&!this.editor.mode.edit?"":"string"==w?"green":"number"==w?"red":"boolean"==w?"darkorange":this._hasChilds()?"":null===m?"#004ED0":"black",u.style.color=p;var q=""==String(this.value)&&"array"!=this.type&&"object"!=this.type;if(q?g.addClassName(u,"empty"):g.removeClassName(u,"empty"),v?g.addClassName(u,"url"):g.removeClassName(u,"url"),"array"==w||"object"==w){var i=this.childs?this.childs.length:0;u.title=this.type+" containing "+i+" items"}else{"string"==w&&g.isUrl(m)?this.editor.mode.edit&&(u.title="Ctrl+Click or Ctrl+Enter to open url in new window"):u.title=""}this.searchValueActive?g.addClassName(u,"highlight-active"):g.removeClassName(u,"highlight-active"),this.searchValue?g.addClassName(u,"highlight"):g.removeClassName(u,"highlight"),g.stripFormatting(u)}},l.prototype._updateDomField=function(){var m=this.dom.field;if(m){var i=""==String(this.field)&&"array"!=this.parent.type;i?g.addClassName(m,"empty"):g.removeClassName(m,"empty"),this.searchFieldActive?g.addClassName(m,"highlight-active"):g.removeClassName(m,"highlight-active"),this.searchField?g.addClassName(m,"highlight"):g.removeClassName(m,"highlight"),g.stripFormatting(m)}},l.prototype._getDomField=function(m){if(this.dom.field&&this.fieldEditable&&(this.fieldInnerText=g.getInnerText(this.dom.field)),void 0!=this.fieldInnerText){try{var i=this._unescapeHTML(this.fieldInnerText);if(i!==this.field){var q=this.field;this.field=i,this.editor._onAction("editField",{node:this,oldValue:q,newValue:i,oldSelection:this.editor.selection,newSelection:this.editor.getSelection()})}}catch(p){if(this.field=void 0,1!=m){throw p}}}},l.prototype.clearDom=function(){this.dom={}},l.prototype.getDom=function(){var r=this.dom;if(r.tr){return r.tr}if(r.tr=document.createElement("tr"),r.tr.node=this,this.editor.mode.edit){var p=document.createElement("td");if(this.parent){var m=document.createElement("button");r.drag=m,m.className="dragarea",m.title="Drag to move this field (Alt+Shift+Arrows)",p.appendChild(m)}r.tr.appendChild(p);var v=document.createElement("td"),u=document.createElement("button");r.menu=u,u.className="contextmenu",u.title="Click to open the actions menu (Ctrl+M)",v.appendChild(r.menu),r.tr.appendChild(v)}var q=document.createElement("td");return r.tr.appendChild(q),r.tree=this._createDomTree(),q.appendChild(r.tree),this.updateDom({updateIndexes:!0}),r.tr},l.prototype._onDragStart=function(m){var i=this;this.mousemove||(this.mousemove=g.addEventListener(document,"mousemove",function(n){i._onDrag(n)})),this.mouseup||(this.mouseup=g.addEventListener(document,"mouseup",function(n){i._onDragEnd(n)})),this.editor.highlighter.lock(),this.drag={oldCursor:document.body.style.cursor,startParent:this.parent,startIndex:this.parent.childs.indexOf(this),mouseX:m.pageX,level:this.getLevel()},document.body.style.cursor="move",m.preventDefault()},l.prototype._onDrag=function(P){var D,F,H,T,Q,L,K,R,A,I,O,J,z,M,n=P.pageY,o=P.pageX,G=!1;if(D=this.dom.tr,A=g.getAbsoluteTop(D),J=D.offsetHeight,A>n){F=D;do{F=F.previousSibling,K=l.getNodeFromTarget(F),I=F?g.getAbsoluteTop(F):0}while(F&&I>n);K&&!K.parent&&(K=void 0),K||(L=D.parentNode.firstChild,F=L?L.nextSibling:void 0,K=l.getNodeFromTarget(F),K==this&&(K=void 0)),K&&(F=K.dom.tr,I=F?g.getAbsoluteTop(F):0,n>I+J&&(K=void 0)),K&&(K.parent.moveBefore(this,K),G=!0)}else{if(Q=this.expanded&&this.append?this.append.getDom():this.dom.tr,T=Q?Q.nextSibling:void 0){O=g.getAbsoluteTop(T),H=T;do{R=l.getNodeFromTarget(H),H&&(z=H.nextSibling?g.getAbsoluteTop(H.nextSibling):0,M=H?z-O:0,1==R.parent.childs.length&&R.parent.childs[0]==this&&(A+=23)),H=H.nextSibling}while(H&&n>A+M);if(R&&R.parent){var S=o-this.drag.mouseX,B=Math.round(S/24/2),i=this.drag.level+B,U=R.getLevel();for(F=R.dom.tr.previousSibling;i>U&&F;){if(K=l.getNodeFromTarget(F),K==this||K._isChildOf(this)){}else{if(!(K instanceof k)){break}var q=K.parent.childs;if(!(q.length>1||1==q.length&&q[0]!=this)){break}R=l.getNodeFromTarget(F),U=R.getLevel()}F=F.previousSibling}Q.nextSibling!=R.dom.tr&&(R.parent.moveBefore(this,R),G=!0)}}}G&&(this.drag.mouseX=o,this.drag.level=this.getLevel()),this.editor.startAutoScroll(n),P.preventDefault()},l.prototype._onDragEnd=function(m){var i={node:this,startParent:this.drag.startParent,startIndex:this.drag.startIndex,endParent:this.parent,endIndex:this.parent.childs.indexOf(this)};(i.startParent!=i.endParent||i.startIndex!=i.endIndex)&&this.editor._onAction("moveNode",i),document.body.style.cursor=this.drag.oldCursor,this.editor.highlighter.unlock(),delete this.drag,this.mousemove&&(g.removeEventListener(document,"mousemove",this.mousemove),delete this.mousemove),this.mouseup&&(g.removeEventListener(document,"mouseup",this.mouseup),delete this.mouseup),this.editor.stopAutoScroll(),m.preventDefault()},l.prototype._isChildOf=function(m){for(var i=this.parent;i;){if(i==m){return !0}i=i.parent}return !1},l.prototype._createDomField=function(){return document.createElement("div")},l.prototype.setHighlight=function(i){this.dom.tr&&(this.dom.tr.className=i?"highlight":"",this.append&&this.append.setHighlight(i),this.childs&&this.childs.forEach(function(e){e.setHighlight(i)}))},l.prototype.updateValue=function(i){this.value=i,this.updateDom()},l.prototype.updateField=function(i){this.field=i,this.updateDom()},l.prototype.updateDom=function(r){var p=this.dom.tree;p&&(p.style.marginLeft=24*this.getLevel()+"px");var m=this.dom.field;if(m){1==this.fieldEditable?(m.contentEditable=this.editor.mode.edit,m.spellcheck=!1,m.className="field"):m.className="readonly";var v;v=void 0!=this.index?this.index:void 0!=this.field?this.field:this._hasChilds()?this.type:"",m.innerHTML=this._escapeHTML(v)}var u=this.dom.value;if(u){var q=this.childs?this.childs.length:0;u.innerHTML="array"==this.type?"["+q+"]":"object"==this.type?"{"+q+"}":this._escapeHTML(this.value)}this._updateDomField(),this._updateDomValue(),r&&1==r.updateIndexes&&this._updateDomIndexes(),r&&1==r.recurse&&this.childs&&this.childs.forEach(function(e){e.updateDom(r)}),this.append&&this.append.updateDom()},l.prototype._updateDomIndexes=function(){var m=this.dom.value,i=this.childs;m&&i&&("array"==this.type?i.forEach(function(p,o){p.index=o;var n=p.dom.field;n&&(n.innerHTML=o)}):"object"==this.type&&i.forEach(function(n){void 0!=n.index&&(delete n.index,void 0==n.field&&(n.field=""))}))},l.prototype._createDomValue=function(){var i;return"array"==this.type?(i=document.createElement("div"),i.className="readonly",i.innerHTML="[...]"):"object"==this.type?(i=document.createElement("div"),i.className="readonly",i.innerHTML="{...}"):!this.editor.mode.edit&&g.isUrl(this.value)?(i=document.createElement("a"),i.className="value",i.href=this.value,i.target="_blank",i.innerHTML=this._escapeHTML(this.value)):(i=document.createElement("div"),i.contentEditable=!this.editor.mode.view,i.spellcheck=!1,i.className="value",i.innerHTML=this._escapeHTML(this.value)),i},l.prototype._createDomExpandButton=function(){var i=document.createElement("button");return this._hasChilds()?(i.className=this.expanded?"expanded":"collapsed",i.title="Click to expand/collapse this field (Ctrl+E). \nCtrl+Click to expand/collapse including all childs."):(i.className="invisible",i.title=""),i},l.prototype._createDomTree=function(){var w=this.dom,q=document.createElement("table"),p=document.createElement("tbody");q.style.borderCollapse="collapse",q.className="values",q.appendChild(p);var y=document.createElement("tr");p.appendChild(y);var x=document.createElement("td");x.className="tree",y.appendChild(x),w.expand=this._createDomExpandButton(),x.appendChild(w.expand),w.tdExpand=x;var u=document.createElement("td");u.className="tree",y.appendChild(u),w.field=this._createDomField(),u.appendChild(w.field),w.tdField=u;var v=document.createElement("td");v.className="tree",y.appendChild(v),"object"!=this.type&&"array"!=this.type&&(v.appendChild(document.createTextNode(":")),v.className="separator"),w.tdSeparator=v;var m=document.createElement("td");return m.className="tree",y.appendChild(m),w.value=this._createDomValue(),m.appendChild(w.value),w.tdValue=m,q},l.prototype.onEvent=function(y){var D,v=y.type,q=y.target||y.srcElement,E=this.dom,i=this,B=this._hasChilds();if((q==E.drag||q==E.menu)&&("mouseover"==v?this.editor.highlighter.highlight(this):"mouseout"==v&&this.editor.highlighter.unhighlight()),"mousedown"==v&&q==E.drag&&this._onDragStart(y),"click"==v&&q==E.menu){var z=i.editor.highlighter;z.highlight(i),z.lock(),g.addClassName(E.menu,"selected"),this.showContextMenu(E.menu,function(){g.removeClassName(E.menu,"selected"),z.unlock(),z.unhighlight()})}if("click"==v&&q==E.expand&&B){var x=y.ctrlKey;this._onExpand(x)}var w=E.value;if(q==w){switch(v){case"focus":D=this;break;case"blur":case"change":this._getDomValue(!0),this._updateDomValue(),this.value&&(w.innerHTML=this._escapeHTML(this.value));break;case"input":this._getDomValue(!0),this._updateDomValue();break;case"keydown":case"mousedown":this.editor.selection=this.editor.getSelection();break;case"click":y.ctrlKey&&this.editor.mode.edit&&g.isUrl(this.value)&&window.open(this.value,"_blank");break;case"keyup":this._getDomValue(!0),this._updateDomValue();break;case"cut":case"paste":setTimeout(function(){i._getDomValue(!0),i._updateDomValue()},1)}}var A=E.field;if(q==A){switch(v){case"focus":D=this;break;case"blur":case"change":this._getDomField(!0),this._updateDomField(),this.field&&(A.innerHTML=this._escapeHTML(this.field));break;case"input":this._getDomField(!0),this._updateDomField();break;case"keydown":case"mousedown":this.editor.selection=this.editor.getSelection();break;case"keyup":this._getDomField(!0),this._updateDomField();break;case"cut":case"paste":setTimeout(function(){i._getDomField(!0),i._updateDomField()},1)}}var C=E.tree;if(q==C.parentNode){switch(v){case"click":var m=void 0!=y.offsetX?y.offsetX<24*(this.getLevel()+1):y.pageX<g.getAbsoluteLeft(E.tdSeparator);m||B?A&&(g.setEndOfContentEditable(A),A.focus()):w&&(g.setEndOfContentEditable(w),w.focus())}}if(q==E.tdExpand&&!B||q==E.tdField||q==E.tdSeparator){switch(v){case"click":A&&(g.setEndOfContentEditable(A),A.focus())}}"keydown"==v&&this.onKeyDown(y)},l.prototype.onKeyDown=function(M){var A,B,F,R,O=M.which||M.keyCode,J=M.target||M.srcElement,I=M.ctrlKey,P=M.shiftKey,w=M.altKey,G=!1;if(13==O){if(J==this.dom.value){(!this.editor.mode.edit||M.ctrlKey)&&g.isUrl(this.value)&&(window.open(this.value,"_blank"),G=!0)}else{if(J==this.dom.expand){var L=this._hasChilds();if(L){var H=M.ctrlKey;this._onExpand(H),J.focus(),G=!0}}}}else{if(68==O){I&&(this._onDuplicate(),G=!0)}else{if(69==O){I&&(this._onExpand(P),J.focus(),G=!0)}else{if(77==O){I&&(this.showContextMenu(J),G=!0)}else{if(46==O){I&&(this._onRemove(),G=!0)}else{if(45==O){I&&!P?(this._onInsertBefore(),G=!0):I&&P&&(this._onInsertAfter(),G=!0)}else{if(35==O){if(w){var q=this._lastNode();q&&q.focus(l.focusElement||this._getElementName(J)),G=!0}}else{if(36==O){if(w){var K=this._firstNode();K&&K.focus(l.focusElement||this._getElementName(J)),G=!0}}else{if(37==O){if(w&&!P){var n=this._previousElement(J);n&&this.focus(this._getElementName(n)),G=!0}else{if(w&&P){if(this.expanded){var o=this.getAppend();F=o?o.nextSibling:void 0}else{var D=this.getDom();F=D.nextSibling}F&&(B=l.getNodeFromTarget(F),R=F.nextSibling,i=l.getNodeFromTarget(R),B&&B instanceof k&&1!=this.parent.childs.length&&i&&i.parent&&(i.parent.moveBefore(this,i),this.focus(l.focusElement||this._getElementName(J))))}}}else{if(38==O){w&&!P?(A=this._previousNode(),A&&A.focus(l.focusElement||this._getElementName(J)),G=!0):w&&P&&(A=this._previousNode(),A&&A.parent&&(A.parent.moveBefore(this,A),this.focus(l.focusElement||this._getElementName(J))),G=!0)}else{if(39==O){if(w&&!P){var Q=this._nextElement(J);Q&&this.focus(this._getElementName(Q)),G=!0}else{if(w&&P){D=this.getDom();var z=D.previousSibling;z&&(A=l.getNodeFromTarget(z),A&&A.parent&&A instanceof k&&!A.isVisible()&&(A.parent.moveBefore(this,A),this.focus(l.focusElement||this._getElementName(J))))}}}else{if(40==O){if(w&&!P){B=this._nextNode(),B&&B.focus(l.focusElement||this._getElementName(J)),G=!0}else{if(w&&P){B=this.expanded?this.append?this.append._nextNode():void 0:this._nextNode(),F=B?B.getDom():void 0,R=1==this.parent.childs.length?F:F?F.nextSibling:void 0;var i=l.getNodeFromTarget(R);i&&i.parent&&(i.parent.moveBefore(this,i),this.focus(l.focusElement||this._getElementName(J))),G=!0}}}}}}}}}}}}}}G&&(M.preventDefault(),M.stopPropagation())},l.prototype._onExpand=function(p){if(p){var o=this.dom.tr.parentNode,m=o.parentNode,q=m.scrollTop;m.removeChild(o)}this.expanded?this.collapse(p):this.expand(p),p&&(m.appendChild(o),m.scrollTop=q)},l.prototype._onRemove=function(){this.editor.highlighter.unhighlight();var p=this.parent.childs,o=p.indexOf(this),m=this.editor.getSelection();p[o+1]?p[o+1].focus():p[o-1]?p[o-1].focus():this.parent.focus();var q=this.editor.getSelection();this.parent._remove(this),this.editor._onAction("removeNode",{node:this,parent:this.parent,index:o,oldSelection:m,newSelection:q})},l.prototype._onDuplicate=function(){var o=this.editor.getSelection(),n=this.parent._duplicate(this);n.focus();var m=this.editor.getSelection();this.editor._onAction("duplicateNode",{node:this,clone:n,parent:this.parent,oldSelection:o,newSelection:m})},l.prototype._onInsertBefore=function(u,n,m){var v=this.editor.getSelection(),p=new l(this.editor,{field:void 0!=u?u:"",value:void 0!=n?n:"",type:m});p.expand(!0),this.parent.insertBefore(p,this),this.editor.highlighter.unhighlight(),p.focus("field");var q=this.editor.getSelection();this.editor._onAction("insertBeforeNode",{node:p,beforeNode:this,parent:this.parent,oldSelection:v,newSelection:q})},l.prototype._onInsertAfter=function(u,n,m){var v=this.editor.getSelection(),p=new l(this.editor,{field:void 0!=u?u:"",value:void 0!=n?n:"",type:m});p.expand(!0),this.parent.insertAfter(p,this),this.editor.highlighter.unhighlight(),p.focus("field");var q=this.editor.getSelection();this.editor._onAction("insertAfterNode",{node:p,afterNode:this,parent:this.parent,oldSelection:v,newSelection:q})},l.prototype._onAppend=function(u,n,m){var v=this.editor.getSelection(),p=new l(this.editor,{field:void 0!=u?u:"",value:void 0!=n?n:"",type:m});p.expand(!0),this.parent.appendChild(p),this.editor.highlighter.unhighlight(),p.focus("field");var q=this.editor.getSelection();this.editor._onAction("appendNode",{node:p,parent:this.parent,oldSelection:v,newSelection:q})},l.prototype._onChangeType=function(p){var o=this.type;if(p!=o){var m=this.editor.getSelection();this.changeType(p);var q=this.editor.getSelection();this.editor._onAction("changeType",{node:this,oldType:o,newType:p,oldSelection:m,newSelection:q})}},l.prototype._onSort=function(q){if(this._hasChilds()){var p="desc"==q?-1:1,m="array"==this.type?"value":"field";this.hideChilds();var s=this.childs,r=this.sort;this.childs=this.childs.concat(),this.childs.sort(function(i,o){return i[m]>o[m]?p:i[m]<o[m]?-p:0}),this.sort=1==p?"asc":"desc",this.editor._onAction("sort",{node:this,oldChilds:s,oldSort:r,newChilds:this.childs,newSort:this.sort}),this.showChilds()}},l.prototype.getAppend=function(){return this.append||(this.append=new k(this.editor),this.append.setParent(this)),this.append.getDom()},l.getNodeFromTarget=function(i){for(;i;){if(i.node){return i.node}i=i.parentNode}return void 0},l.prototype._previousNode=function(){var o=null,n=this.getDom();if(n&&n.parentNode){var m=n;do{m=m.previousSibling,o=l.getNodeFromTarget(m)}while(m&&o instanceof k&&!o.isVisible())}return o},l.prototype._nextNode=function(){var o=null,n=this.getDom();if(n&&n.parentNode){var m=n;do{m=m.nextSibling,o=l.getNodeFromTarget(m)}while(m&&o instanceof k&&!o.isVisible())}return o},l.prototype._firstNode=function(){var o=null,n=this.getDom();if(n&&n.parentNode){var m=n.parentNode.firstChild;o=l.getNodeFromTarget(m)}return o},l.prototype._lastNode=function(){var o=null,n=this.getDom();if(n&&n.parentNode){var m=n.parentNode.lastChild;for(o=l.getNodeFromTarget(m);m&&o instanceof k&&!o.isVisible();){m=m.previousSibling,o=l.getNodeFromTarget(m)}}return o},l.prototype._previousElement=function(m){var i=this.dom;switch(m){case i.value:if(this.fieldEditable){return i.field}case i.field:if(this._hasChilds()){return i.expand}case i.expand:return i.menu;case i.menu:if(i.drag){return i.drag}default:return null}},l.prototype._nextElement=function(m){var i=this.dom;switch(m){case i.drag:return i.menu;case i.menu:if(this._hasChilds()){return i.expand}case i.expand:if(this.fieldEditable){return i.field}case i.field:if(!this._hasChilds()){return i.value}default:return null}},l.prototype._getElementName=function(o){var n=this.dom;for(var m in n){if(n.hasOwnProperty(m)&&n[m]==o){return m}}return null},l.prototype._hasChilds=function(){return"array"==this.type||"object"==this.type},l.TYPE_TITLES={auto:'Field type "auto". The field type is automatically determined from the value and can be a string, number, boolean, or null.',object:'Field type "object". An object contains an unordered set of key/value pairs.',array:'Field type "array". An array contains an ordered collection of values.',string:'Field type "string". Field type is not determined from the value, but always returned as string.'},l.prototype.showContextMenu=function(n,m){var w=this,q=l.TYPE_TITLES,u=[];if(u.push({text:"Type",title:"Change the type of this field",className:"type-"+this.type,submenu:[{text:"Auto",className:"type-auto"+("auto"==this.type?" selected":""),title:q.auto,click:function(){w._onChangeType("auto")}},{text:"Array",className:"type-array"+("array"==this.type?" selected":""),title:q.array,click:function(){w._onChangeType("array")}},{text:"Object",className:"type-object"+("object"==this.type?" selected":""),title:q.object,click:function(){w._onChangeType("object")}},{text:"String",className:"type-string"+("string"==this.type?" selected":""),title:q.string,click:function(){w._onChangeType("string")}}]}),this._hasChilds()){var e="asc"==this.sort?"desc":"asc";u.push({text:"Sort",title:"Sort the childs of this "+this.type,className:"sort-"+e,click:function(){w._onSort(e)},submenu:[{text:"Ascending",className:"sort-asc",title:"Sort the childs of this "+this.type+" in ascending order",click:function(){w._onSort("asc")}},{text:"Descending",className:"sort-desc",title:"Sort the childs of this "+this.type+" in descending order",click:function(){w._onSort("desc")}}]})}if(this.parent&&this.parent._hasChilds()){u.push({type:"separator"});var v=w.parent.childs;w==v[v.length-1]&&u.push({text:"Append",title:"Append a new field with type 'auto' after this field (Ctrl+Shift+Ins)",submenuTitle:"Select the type of the field to be appended",className:"append",click:function(){w._onAppend("","","auto")},submenu:[{text:"Auto",className:"type-auto",title:q.auto,click:function(){w._onAppend("","","auto")}},{text:"Array",className:"type-array",title:q.array,click:function(){w._onAppend("",[])}},{text:"Object",className:"type-object",title:q.object,click:function(){w._onAppend("",{})}},{text:"String",className:"type-string",title:q.string,click:function(){w._onAppend("","","string")}}]}),u.push({text:"Insert",title:"Insert a new field with type 'auto' before this field (Ctrl+Ins)",submenuTitle:"Select the type of the field to be inserted",className:"insert",click:function(){w._onInsertBefore("","","auto")},submenu:[{text:"Auto",className:"type-auto",title:q.auto,click:function(){w._onInsertBefore("","","auto")}},{text:"Array",className:"type-array",title:q.array,click:function(){w._onInsertBefore("",[])}},{text:"Object",className:"type-object",title:q.object,click:function(){w._onInsertBefore("",{})}},{text:"String",className:"type-string",title:q.string,click:function(){w._onInsertBefore("","","string")}}]}),u.push({text:"Duplicate",title:"Duplicate this field (Ctrl+D)",className:"duplicate",click:function(){w._onDuplicate()}}),u.push({text:"Remove",title:"Remove this field (Ctrl+Del)",className:"remove",click:function(){w._onRemove()}})}var p=new j(u,{close:m});p.show(n)},l.prototype._getType=function(i){return i instanceof Array?"array":i instanceof Object?"object":"string"==typeof i&&"string"!=typeof this._stringCast(i)?"string":"auto"},l.prototype._stringCast=function(p){var o=p.toLowerCase(),m=Number(p),q=parseFloat(p);return""==p?"":"null"==o?null:"true"==o?!0:"false"==o?!1:isNaN(m)||isNaN(q)?p:m},l.prototype._escapeHTML=function(o){var n=String(o).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/  /g," &nbsp;").replace(/^ /,"&nbsp;").replace(/ $/,"&nbsp;"),m=JSON.stringify(n);return m.substring(1,m.length-1)},l.prototype._unescapeHTML=function(m){var i='"'+this._escapeJSON(m)+'"',o=g.parse(i);return o.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;|\u00A0/g," ")},l.prototype._escapeJSON=function(q){for(var p="",m=0,s=q.length;s>m;){var r=q.charAt(m);"\n"==r?p+="\\n":"\\"==r?(p+=r,m++,r=q.charAt(m),-1=='"\\/bfnrtu'.indexOf(r)&&(p+="\\"),p+=r):p+='"'==r?'\\"':r,m++}return p};var k=h(l);return l}.apply(null,f),!(void 0!==d&&(c.exports=d))},function(c,b,a){var f,d;f=[a(9)],d=function(h){function g(z,p,k){function j(n){z.setMode(n);var l=z.dom&&z.dom.modeBox;l&&l.focus()}for(var A={code:{text:"Code",title:"Switch to code highlighter",click:function(){j("code")}},form:{text:"Form",title:"Switch to form editor",click:function(){j("form")}},text:{text:"Text",title:"Switch to plain text editor",click:function(){j("text")}},tree:{text:"Tree",title:"Switch to tree editor",click:function(){j("tree")}},view:{text:"View",title:"Switch to tree view",click:function(){j("view")}}},e=[],x=0;x<p.length;x++){var v=p[x],q=A[v];if(!q){throw new Error('Unknown mode "'+v+'"')}q.className="type-modes"+(k==v?" selected":""),e.push(q)}var m=A[k];if(!m){throw new Error('Unknown mode "'+k+'"')}var w=m.text,y=document.createElement("button");return y.className="modes separator",y.innerHTML=w+" &#x25BE;",y.title="Switch editor mode",y.onclick=function(){var i=new h(e);i.show(y)},y}return{create:g}}.apply(null,f),!(void 0!==d&&(c.exports=d))},function(c,b,a){var f,d;f=[a(3)],d=function(h){function g(p,v){function m(n,i,r){r.forEach(function(x){if("separator"==x.type){var F=document.createElement("div");F.className="separator",D=document.createElement("li"),D.appendChild(F),n.appendChild(D)}else{var e={},D=document.createElement("li");n.appendChild(D);var B=document.createElement("button");if(B.className=x.className,e.button=B,x.title&&(B.title=x.title),x.click&&(B.onclick=function(){l.hide(),x.click()}),D.appendChild(B),x.submenu){var z=document.createElement("div");z.className="icon",B.appendChild(z),B.appendChild(document.createTextNode(x.text));var y;if(x.click){B.className+=" default";var C=document.createElement("button");e.buttonExpand=C,C.className="expand",C.innerHTML='<div class="expand"></div>',D.appendChild(C),x.submenuTitle&&(C.title=x.submenuTitle),y=C}else{var E=document.createElement("div");E.className="expand",B.appendChild(E),y=B}y.onclick=function(){l._onExpandItem(e),y.focus()};var t=[];e.subItems=t;var A=document.createElement("ul");e.ul=A,A.className="menu",A.style.height="0",D.appendChild(A),m(A,t,x.submenu)}else{B.innerHTML='<div class="icon"></div>'+x.text}i.push(e)}})}this.dom={};var l=this,k=this.dom;this.anchor=void 0,this.items=p,this.eventListeners={},this.selection=void 0,this.visibleSubmenu=void 0,this.onClose=v?v.close:void 0;var w=document.createElement("div");w.className="jsoneditor-contextmenu",k.menu=w;var j=document.createElement("ul");j.className="menu",w.appendChild(j),k.list=j,k.items=[];var u=document.createElement("button");k.focusButton=u;var q=document.createElement("li");q.style.overflow="hidden",q.style.height="0",q.appendChild(u),j.appendChild(q),m(j,this.dom.items,p),this.maxHeight=0,p.forEach(function(n){var e=24*(p.length+(n.submenu?n.submenu.length:0));l.maxHeight=Math.max(l.maxHeight,e)})}return g.prototype._getVisibleButtons=function(){var j=[],i=this;return this.dom.items.forEach(function(e){j.push(e.button),e.buttonExpand&&j.push(e.buttonExpand),e.subItems&&e==i.expandedItem&&e.subItems.forEach(function(k){j.push(k.button),k.buttonExpand&&j.push(k.buttonExpand)})}),j},g.visibleMenu=void 0,g.prototype.show=function(p){this.hide();var k=window.innerHeight,j=window.pageYOffset||document.scrollTop||0,w=k+j,e=p.offsetHeight,v=this.maxHeight,t=h.getAbsoluteLeft(p),q=h.getAbsoluteTop(p);w>q+e+v?(this.dom.menu.style.left=t+"px",this.dom.menu.style.top=q+e+"px",this.dom.menu.style.bottom=""):(this.dom.menu.style.left=t+"px",this.dom.menu.style.top="",this.dom.menu.style.bottom=k-q+"px"),document.body.appendChild(this.dom.menu);var m=this,u=this.dom.list;this.eventListeners.mousedown=h.addEventListener(document,"mousedown",function(l){var i=l.target;i==u||m._isChildOf(i,u)||(m.hide(),l.stopPropagation(),l.preventDefault())}),this.eventListeners.mousewheel=h.addEventListener(document,"mousewheel",function(i){i.stopPropagation(),i.preventDefault()}),this.eventListeners.keydown=h.addEventListener(document,"keydown",function(i){m._onKeyDown(i)}),this.selection=h.getSelection(),this.anchor=p,setTimeout(function(){m.dom.focusButton.focus()},0),g.visibleMenu&&g.visibleMenu.hide(),g.visibleMenu=this},g.prototype.hide=function(){this.dom.menu.parentNode&&(this.dom.menu.parentNode.removeChild(this.dom.menu),this.onClose&&this.onClose());for(var e in this.eventListeners){if(this.eventListeners.hasOwnProperty(e)){var j=this.eventListeners[e];j&&h.removeEventListener(document,e,j),delete this.eventListeners[e]}}g.visibleMenu==this&&(g.visibleMenu=void 0)},g.prototype._onExpandItem=function(j){var e=this,m=j==this.expandedItem,l=this.expandedItem;if(l&&(l.ul.style.height="0",l.ul.style.padding="",setTimeout(function(){e.expandedItem!=l&&(l.ul.style.display="",h.removeClassName(l.ul.parentNode,"selected"))},300),this.expandedItem=void 0),!m){var k=j.ul;k.style.display="block";k.clientHeight;setTimeout(function(){e.expandedItem==j&&(k.style.height=24*k.childNodes.length+"px",k.style.padding="5px 10px")},0),h.addClassName(k.parentNode,"selected"),this.expandedItem=j}},g.prototype._onKeyDown=function(k){var j,u,q,l,m=k.target,e=k.which,p=!1;27==e?(this.selection&&h.setSelection(this.selection),this.anchor&&this.anchor.focus(),this.hide(),p=!0):9==e?k.shiftKey?(j=this._getVisibleButtons(),u=j.indexOf(m),0==u&&(j[j.length-1].focus(),p=!0)):(j=this._getVisibleButtons(),u=j.indexOf(m),u==j.length-1&&(j[0].focus(),p=!0)):37==e?("expand"==m.className&&(j=this._getVisibleButtons(),u=j.indexOf(m),q=j[u-1],q&&q.focus()),p=!0):38==e?(j=this._getVisibleButtons(),u=j.indexOf(m),q=j[u-1],q&&"expand"==q.className&&(q=j[u-2]),q||(q=j[j.length-1]),q&&q.focus(),p=!0):39==e?(j=this._getVisibleButtons(),u=j.indexOf(m),l=j[u+1],l&&"expand"==l.className&&l.focus(),p=!0):40==e&&(j=this._getVisibleButtons(),u=j.indexOf(m),l=j[u+1],l&&"expand"==l.className&&(l=j[u+2]),l||(l=j[0]),l&&(l.focus(),p=!0),p=!0),p&&(k.stopPropagation(),k.preventDefault())},g.prototype._isChildOf=function(l,k){for(var j=l.parentNode;j;){if(j==k){return !0}j=j.parentNode}return !1},g}.apply(null,f),!(void 0!==d&&(c.exports=d))},function(c,b,a){var f,d;f=[a(9),a(3)],d=function(j,h){function g(e){function k(i){this.editor=i,this.dom={}}return k.prototype=new e,k.prototype.getDom=function(){var q=this.dom;if(q.tr){return q.tr}var m=document.createElement("tr");if(m.node=this,q.tr=m,this.editor.mode.edit){q.tdDrag=document.createElement("td");var l=document.createElement("td");q.tdMenu=l;var u=document.createElement("button");u.className="contextmenu",u.title="Click to open the actions menu (Ctrl+M)",q.menu=u,l.appendChild(q.menu)}var r=document.createElement("td"),p=document.createElement("div");return p.innerHTML="(empty)",p.className="readonly",r.appendChild(p),q.td=r,q.text=p,this.updateDom(),m},k.prototype.updateDom=function(){var o=this.dom,m=o.td;m&&(m.style.paddingLeft=24*this.getLevel()+26+"px");var l=o.text;l&&(l.innerHTML="(empty "+this.parent.type+")");var p=o.tr;this.isVisible()?o.tr.firstChild||(o.tdDrag&&p.appendChild(o.tdDrag),o.tdMenu&&p.appendChild(o.tdMenu),p.appendChild(m)):o.tr.firstChild&&(o.tdDrag&&p.removeChild(o.tdDrag),o.tdMenu&&p.removeChild(o.tdMenu),p.removeChild(m))},k.prototype.isVisible=function(){return 0==this.parent.childs.length},k.prototype.showContextMenu=function(l,u){var q=this,m=e.TYPE_TITLES,p=[{text:"Append",title:"Append a new field with type 'auto' (Ctrl+Shift+Ins)",submenuTitle:"Select the type of the field to be appended",className:"insert",click:function(){q._onAppend("","","auto")},submenu:[{text:"Auto",className:"type-auto",title:m.auto,click:function(){q._onAppend("","","auto")}},{text:"Array",className:"type-array",title:m.array,click:function(){q._onAppend("",[])}},{text:"Object",className:"type-object",title:m.object,click:function(){q._onAppend("",{})}},{text:"String",className:"type-string",title:m.string,click:function(){q._onAppend("","","string")}}]}],i=new j(p,{close:u});i.show(l)},k.prototype.onEvent=function(q){var l=q.type,u=q.target||q.srcElement,t=this.dom,m=t.menu;if(u==m&&("mouseover"==l?this.editor.highlighter.highlight(this.parent):"mouseout"==l&&this.editor.highlighter.unhighlight()),"click"==l&&u==t.menu){var p=this.editor.highlighter;p.highlight(this.parent),p.lock(),h.addClassName(t.menu,"selected"),this.showContextMenu(t.menu,function(){h.removeClassName(t.menu,"selected"),p.unlock(),p.unhighlight()})}"keydown"==l&&this.onKeyDown(q)},k}return g}.apply(null,f),!(void 0!==d&&(c.exports=d))}])});var base64 = {
	keyStr : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
	encode : function (input) {
		input = base64.unicodetoBytes(input);
		var output = "";
		var chr1, chr2, chr3 = "";
		var enc1, enc2, enc3, enc4 = "";
		var i = 0;
		do {
			chr1 = input[i++];
			chr2 = input[i++];
			chr3 = input[i++];
			enc1 = chr1 >> 2;
			enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
			enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
			enc4 = chr3 & 63;
			if (isNaN(chr2)) {
				enc3 = enc4 = 64;
			} else if (isNaN(chr3)) {
				enc4 = 64;
			}

			output = output + base64.keyStr.charAt(enc1) + base64.keyStr.charAt(enc2) + base64.keyStr.charAt(enc3) + base64.keyStr.charAt(enc4);
			chr1 = chr2 = chr3 = "";
			enc1 = enc2 = enc3 = enc4 = "";
		} while (i < input.length);
		return output;
	},
	decode : function (input) {
		var output = "";
		var chr1, chr2, chr3 = "";
		var enc1, enc2, enc3, enc4 = "";
		var i = 0;
		// remove all characters that are not A-Z, a-z, 0-9, +, /, or =
		var base64test = /[^A-Za-z0-9\+\/\=]/g;
		if (base64test.exec(input)) {
			alert("There were invalid base64 characters in the input text.\n" +
				"Valid base64 characters are A-Z, a-z, 0-9, '+', '/', and '='\n" +
				"Expect errors in decoding.");
		}

		input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");
		output = new Array();
		do {
			enc1 = base64.keyStr.indexOf(input.charAt(i++));
			enc2 = base64.keyStr.indexOf(input.charAt(i++));
			enc3 = base64.keyStr.indexOf(input.charAt(i++));
			enc4 = base64.keyStr.indexOf(input.charAt(i++));
			chr1 = (enc1 << 2) | (enc2 >> 4);
			chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
			chr3 = ((enc3 & 3) << 6) | enc4;
			output.push(chr1);
			if (enc3 != 64) {
				output.push(chr2);
			}

			if (enc4 != 64) {
				output.push(chr3);
			}
			chr1 = chr2 = chr3 = "";
			enc1 = enc2 = enc3 = enc4 = "";
		} while (i < input.length);
		return base64.bytesToUnicode(output);
	},
	unicodetoBytes : function (s) {
		var result = new Array();
		if (s == null || s == "")
			return result;
		result.push(255); // add "FE" to head
		result.push(254);
		for (var i = 0; i < s.length; i++) {
			var c = s.charCodeAt(i).toString(16);
			if (c.length == 1)
				i = "000" + c;
			else if (c.length == 2)
				c = "00" + c;
			else if (c.length == 3)
				c = "0" + c;
			var var1 = parseInt(c.substring(2), 16);
			var var2 = parseInt(c.substring(0, 2), 16);
			result.push(var1);
			result.push(var2);
		}
		return result;
	},
	bytesToUnicode : function (bs) {
		var result = "";
		var offset = 0;
		if (bs.length >= 2 && bs[0] == 255 && bs[1] == 254)
			offset = 2; // delete "FE"
		for (var i = offset; i < bs.length; i += 2) {
			var code = bs[i] + (bs[i + 1] << 8);
			result += String.fromCharCode(code);
		}
		return result;
	}
};